<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>–Ñ-–°–≤—ñ—Ç–ª–æ ‚Äî –¢–µ—Ä–Ω–æ–ø—ñ–ª—å</title>

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#020617">
<link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/2988/2988014.png">

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;900&display=swap" rel="stylesheet">

<style>
:root{--bg:#020617;--card:rgba(30,41,59,.55);--text:#fff}
.light{--bg:#f8fafc;--card:rgba(255,255,255,.75);--text:#0f172a}
body{font-family:Inter,sans-serif;background:var(--bg);color:var(--text);transition:.3s}
.card{background:var(--card);backdrop-filter:blur(18px);border:1px solid rgba(255,255,255,.08)}
.g{box-shadow:0 0 35px -10px #22c55e;border-color:#22c55e55}
.r{box-shadow:0 0 35px -10px #ef4444;border-color:#ef444455}
.y{box-shadow:0 0 35px -10px #eab308;border-color:#eab30855}
</style>
</head>

<body class="p-4 min-h-screen flex items-center justify-center">

<div class="max-w-md w-full space-y-4">

<div class="flex justify-between items-center px-2">
    <div>
        <h1 class="text-3xl font-black italic">–Ñ-–°–í–Ü–¢–õ–û</h1>
        <p class="text-[10px] opacity-40 uppercase tracking-widest">–¢–µ—Ä–Ω–æ–ø—ñ–ª—å</p>
    </div>
    <div class="flex items-center gap-3">
        <button onclick="theme()" class="p-2 rounded-xl card active:scale-90">
            <span id="iconTheme">üåô</span>
        </button>
        <div id="clock" class="text-xl font-black text-yellow-500">00:00:00</div>
    </div>
</div>

<div id="main" class="card rounded-[2.5rem] p-8 text-center border-2 transition-all">
    <div id="icon" class="text-7xl mb-4">‚åõ</div>
    <h2 id="title" class="text-3xl font-black uppercase">...</h2>

    <div class="mt-4 p-4 rounded-3xl bg-black/20 inline-block px-8 border border-white/5">
        <p class="text-[9px] uppercase font-bold opacity-40 tracking-widest mb-1">–î–æ –∑–º—ñ–Ω–∏ —Å—Ç–∞—Ç—É—Å—É</p>
        <div id="timer" class="text-3xl font-black font-mono">00:00:00</div>
        <div id="next" class="text-[10px] mt-2 opacity-60"></div>
    </div>
</div>

<div class="grid grid-cols-2 gap-3">
    <div class="card rounded-2xl p-4 text-center">
        <p class="text-[9px] uppercase opacity-40 font-bold">–°–≤—ñ—Ç–ª–æ –±—É–¥–µ</p>
        <div class="text-xl font-black text-green-400"><span id="on">0</span> –≥–æ–¥</div>
    </div>
    <div class="card rounded-2xl p-4 text-center">
        <p class="text-[9px] uppercase opacity-40 font-bold">–ú–æ–∂–ª–∏–≤–µ</p>
        <div class="text-xl font-black text-yellow-400"><span id="maybe">0</span> –≥–æ–¥</div>
    </div>
</div>

<div class="card rounded-2xl p-4">
    <select id="group" class="w-full bg-transparent text-yellow-500 font-black text-center outline-none">
        <option>1.1</option><option>1.2</option>
        <option>2.1</option><option>2.2</option>
        <option>3.1</option><option>3.2</option>
        <option>4.1</option><option>4.2</option>
        <option>5.1</option><option>5.2</option>
        <option>6.1</option><option>6.2</option>
    </select>
</div>

<div class="card rounded-2xl p-6">
    <div id="line" class="flex gap-1 h-10 items-end"></div>
    <div class="flex justify-between mt-3 text-[9px] opacity-30 font-bold">
        <span>00:00</span><span>12:00</span><span>23:59</span>
    </div>
</div>

</div>

<script>
const KEY='ternopil_light';
let data=null,last=0,alerted=false;

function theme(){
document.body.classList.toggle('light');
localStorage.setItem('theme',document.body.classList.contains('light')?'l':'d');
}
if(localStorage.getItem('theme')==='l')theme();

async function load(){
if(!data||Date.now()-last>300000){
const r=await fetch('schedule.json?v='+Date.now());
data=await r.json();last=Date.now();}
return data;
}

function nextHour(s,h){
let n=(h+1)%24;
while(s[n]===s[h]){n=(n+1)%24;if(n===h)break}
return n;
}

function timerTo(t){
const d=Math.max(0,t-new Date());
timer.textContent=
`${String(Math.floor(d/3600000)).padStart(2,'0')}:`+
`${String(Math.floor(d%3600000/60000)).padStart(2,'0')}:`+
`${String(Math.floor(d%60000/1000)).padStart(2,'0')}`;
}

async function update(){
const now=new Date(),h=now.getHours();
clock.textContent=now.toLocaleTimeString('uk-UA',{hour12:false});
localStorage.setItem(KEY,group.value);

const g=await load();
const s=g.groups[group.value];
const st=s[h];
const n=nextHour(s,h);

const t=new Date();
if(n<=h)t.setDate(t.getDate()+1);
t.setHours(n,0,0,0);
timerTo(t);

on.textContent=s.filter(x=>x===1).length;
maybe.textContent=s.filter(x=>x===2).length;

main.className='card rounded-[2.5rem] p-8 text-center border-2 transition-all';
if(st===1){main.classList.add('g');title.textContent='–°–≤—ñ—Ç–ª–æ —î';icon.textContent='üí°'}
else if(st===0){main.classList.add('r');title.textContent='–í–∏–º–∫–Ω–µ–Ω–æ';icon.textContent='üåë'}
else{main.classList.add('y');title.textContent='–ú–æ–∂–ª–∏–≤–æ';icon.textContent='‚è≥'}

next.textContent=s[n]===1?'–î–∞–ª—ñ: —Å–≤—ñ—Ç–ª–æ –±—É–¥–µ':s[n]===0?'–î–∞–ª—ñ: –≤–∏–º–∫–Ω–µ–Ω–Ω—è':'–î–∞–ª—ñ: –º–æ–∂–ª–∏–≤–æ';

if(st===1&&s[n]===0&&!alerted&&((t-now)/60000)<=15){
alert('–°–≤—ñ—Ç–ª–æ —Å–∫–æ—Ä–æ –≤–∏–º–∫–Ω—É—Ç—å');alerted=true;}
if(st!==1)alerted=false;

line.innerHTML='';
s.forEach((x,i)=>{
const b=document.createElement('div');
b.className=`flex-1 rounded-full ${x===1?'bg-green-500':x===0?'bg-red-500':'bg-yellow-500'} ${i===h?'h-full':'h-1/2 opacity-20'}`;
line.appendChild(b);
});
}

group.value=localStorage.getItem(KEY)||'1.1';
group.onchange=update;
setInterval(update,1000);
update();
</script>

</body>
</html>
